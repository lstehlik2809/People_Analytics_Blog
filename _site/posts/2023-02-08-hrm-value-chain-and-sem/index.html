<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Ludek's Blog About People Analytics: HRM value chain and structural equation modeling - Moneyball case</title>

<meta property="description" itemprop="description" content="What&#39;s the link between the HRM value chain and structural equation modeling? Let’s check it out."/>

<link rel="canonical" href="https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2023-02-08"/>
<meta property="article:created" itemprop="dateCreated" content="2023-02-08"/>
<meta name="article:author" content="Ludek Stehlík"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Ludek&#39;s Blog About People Analytics: HRM value chain and structural equation modeling - Moneyball case"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="What&#39;s the link between the HRM value chain and structural equation modeling? Let’s check it out."/>
<meta property="og:url" content="https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/"/>
<meta property="og:image" content="https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/./baseball.jpg"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Ludek&#39;s Blog About People Analytics"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Ludek&#39;s Blog About People Analytics: HRM value chain and structural equation modeling - Moneyball case"/>
<meta property="twitter:description" content="What&#39;s the link between the HRM value chain and structural equation modeling? Let’s check it out."/>
<meta property="twitter:url" content="https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/"/>
<meta property="twitter:image" content="https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/./baseball.jpg"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Ludek&#39;s Blog About People Analytics: HRM value chain and structural equation modeling - Moneyball case"/>
<meta name="citation_fulltext_html_url" content="https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/"/>
<meta name="citation_online_date" content="2023/02/08"/>
<meta name="citation_publication_date" content="2023/02/08"/>
<meta name="citation_author" content="Ludek Stehlík"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","preview","author","date","categories","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["HRM value chain and structural equation modeling - Moneyball case"]},{"type":"character","attributes":{},"value":["What's the link between the HRM value chain and structural equation modeling? Let’s check it out."]},{"type":"character","attributes":{},"value":["./baseball.jpg"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Ludek Stehlík"]},{"type":"character","attributes":{},"value":["https://www.linkedin.com/in/ludekstehlik/"]}]}]},{"type":"character","attributes":{},"value":["02-08-2023"]},{"type":"character","attributes":{},"value":["hrm value chain","people analytics","path analysis","structural equation modeling","bayesian statistics","r"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth","toc_float","code_folding"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/"]},{"type":"character","attributes":{},"value":["https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["baseball.csv","baseball.jpg","conceptualModel.png","hrm-value-chain-and-sem_files/anchor-4.2.2/anchor.min.js","hrm-value-chain-and-sem_files/bowser-1.9.3/bowser.min.js","hrm-value-chain-and-sem_files/crosstalk-1.2.0/css/crosstalk.min.css","hrm-value-chain-and-sem_files/crosstalk-1.2.0/js/crosstalk.js","hrm-value-chain-and-sem_files/crosstalk-1.2.0/js/crosstalk.js.map","hrm-value-chain-and-sem_files/crosstalk-1.2.0/js/crosstalk.min.js","hrm-value-chain-and-sem_files/crosstalk-1.2.0/js/crosstalk.min.js.map","hrm-value-chain-and-sem_files/crosstalk-1.2.0/scss/crosstalk.scss","hrm-value-chain-and-sem_files/datatables-binding-0.22/datatables.js","hrm-value-chain-and-sem_files/datatables-css-0.0.0/datatables-crosstalk.css","hrm-value-chain-and-sem_files/distill-2.2.21/template.v2.js","hrm-value-chain-and-sem_files/dt-core-1.11.3/css/jquery.dataTables.extra.css","hrm-value-chain-and-sem_files/dt-core-1.11.3/css/jquery.dataTables.min.css","hrm-value-chain-and-sem_files/dt-core-1.11.3/js/jquery.dataTables.min.js","hrm-value-chain-and-sem_files/dt-ext-buttons-1.11.3/css/buttons.dataTables.min.css","hrm-value-chain-and-sem_files/dt-ext-buttons-1.11.3/js/buttons.colVis.min.js","hrm-value-chain-and-sem_files/dt-ext-buttons-1.11.3/js/buttons.html5.min.js","hrm-value-chain-and-sem_files/dt-ext-buttons-1.11.3/js/buttons.print.min.js","hrm-value-chain-and-sem_files/dt-ext-buttons-1.11.3/js/dataTables.buttons.min.js","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-10-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-11-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-2-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-3-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-4-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-5-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-6-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-7-1.png","hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-8-1.png","hrm-value-chain-and-sem_files/header-attrs-2.11/header-attrs.js","hrm-value-chain-and-sem_files/htmlwidgets-1.5.4/htmlwidgets.js","hrm-value-chain-and-sem_files/jquery-3.6.0/jquery-3.6.0.js","hrm-value-chain-and-sem_files/jquery-3.6.0/jquery-3.6.0.min.js","hrm-value-chain-and-sem_files/jquery-3.6.0/jquery-3.6.0.min.map","hrm-value-chain-and-sem_files/nouislider-7.0.10/jquery.nouislider.min.css","hrm-value-chain-and-sem_files/nouislider-7.0.10/jquery.nouislider.min.js","hrm-value-chain-and-sem_files/popper-2.6.0/popper.min.js","hrm-value-chain-and-sem_files/selectize-0.12.0/selectize.bootstrap3.css","hrm-value-chain-and-sem_files/selectize-0.12.0/selectize.min.js","hrm-value-chain-and-sem_files/tippy-6.2.7/tippy-bundle.umd.min.js","hrm-value-chain-and-sem_files/tippy-6.2.7/tippy-light-border.css","hrm-value-chain-and-sem_files/tippy-6.2.7/tippy.css","hrm-value-chain-and-sem_files/tippy-6.2.7/tippy.umd.min.js","hrm-value-chain-and-sem_files/webcomponents-2.0.0/webcomponents.js","hrmValueChain1.png","hrmValueChain2.png","MoneyballClip1.mp4","salaries.csv","teams.csv"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
  <script src="../../site_libs/datatables-binding-0.22/datatables.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="../../site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
  <link href="../../site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
  <script src="../../site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
  <link href="../../site_libs/dt-ext-buttons-1.11.3/css/buttons.dataTables.min.css" rel="stylesheet" />
  <script src="../../site_libs/dt-ext-buttons-1.11.3/js/dataTables.buttons.min.js"></script>
  <script src="../../site_libs/dt-ext-buttons-1.11.3/js/buttons.html5.min.js"></script>
  <script src="../../site_libs/dt-ext-buttons-1.11.3/js/buttons.colVis.min.js"></script>
  <script src="../../site_libs/dt-ext-buttons-1.11.3/js/buttons.print.min.js"></script>
  <link href="../../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
  <script src="../../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
  <link href="../../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
  <script src="../../site_libs/selectize-0.12.0/selectize.min.js"></script>
  <link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
  <script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"HRM value chain and structural equation modeling - Moneyball case","description":"What's the link between the HRM value chain and structural equation modeling? Let’s check it out.","authors":[{"author":"Ludek Stehlík","authorURL":"https://www.linkedin.com/in/ludekstehlik/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2023-02-08T00:00:00.000+01:00","citationText":"Stehlík, 2023"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../images/ludekstehlik.jpg"/>
</span>
<a href="../../index.html" class="title">Ludek's Blog About People Analytics</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="../../bio.html">Bio</a>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>HRM value chain and structural equation modeling - Moneyball case</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:hrm_value_chain" class="dt-tag">hrm value chain</a>
  <a href="../../index.html#category:people_analytics" class="dt-tag">people analytics</a>
  <a href="../../index.html#category:path_analysis" class="dt-tag">path analysis</a>
  <a href="../../index.html#category:structural_equation_modeling" class="dt-tag">structural equation modeling</a>
  <a href="../../index.html#category:bayesian_statistics" class="dt-tag">bayesian statistics</a>
  <a href="../../index.html#category:r" class="dt-tag">r</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>What’s the link between the HRM value chain and structural
equation modeling? Let’s check it out.</p></p>
</div>

<div class="d-byline">
  Luděk Stehlík <a href="https://www.linkedin.com/in/ludekstehlik/"
class="uri">https://www.linkedin.com/in/ludekstehlik/</a> 
  
<br/>02-08-2023
</div>

<div class="d-article">
<p>As the economy cooled, more posts started appearing in my social
bubble about how people analytics can prove its value, justify its
existence, and increase its resilience to layoffs.</p>
<p>One of the often-mentioned conceptual tools in this context is the
<strong>HRM value chain</strong> which shows how people processes lead
to achieving companies’ desired business outcomes. There are more
versions of this tool, e.g. one from <a
href="https://www.tandfonline.com/doi/abs/10.1080/095851997341621?journalCode=rijh20">Jaap
Paauwe and Ray Richardson</a> or another one from <a
href="https://www.hrzone.com/lead/strategy/why-hr-needs-to-up-its-game-in-strategic-people-analytics">Max
Blumberg</a>, but what they have in common is a kind of causal flow from
HRM activities to HRM outcomes to business outcomes.</p>
<p><img src="hrmValueChain1.png"> <em>Example of the HRM value chain
model from <a
href="https://www.tandfonline.com/doi/abs/10.1080/095851997341621?journalCode=rijh20">Paauwe
&amp; Richardson (1997)</a>.</em></p>
<p><br /></p>
<p><img src="hrmValueChain2.png"> <em>Example of the HRM value chain
model from <a
href="https://www.hrzone.com/lead/strategy/why-hr-needs-to-up-its-game-in-strategic-people-analytics">Blumberg
(2018)</a>.</em></p>
<p>However, as potentially useful as this metaphor of the organization
as a kind of “machine” with certain inputs, processes, and outputs is,
it is still only a conceptual tool that may or may not correspond to the
reality of a particular organization.</p>
<p>In this regard, it may help if we try to operationalize this
metaphor. In this effort, <strong><a
href="https://en.wikipedia.org/wiki/Structural_equation_modeling">structural
equation modeling</a></strong> can be very handy, as it allows us to
formalize our ideas about the relationships between several different
variables and to assess the extent to which these ideas are consistent
with the available data. After all, no one wants to make decisions based
on false assumptions.</p>
<p>To illustrate this with a more tangible example, let’s use <a
href="https://en.wikipedia.org/wiki/Sabermetrics">sabermetric</a> data
from the famous <strong><a
href="https://en.wikipedia.org/wiki/Moneyball">Moneyball</a></strong>
case and let’s try to formally model the <a
href="https://en.wikipedia.org/wiki/Oakland_Athletics">Oakland A’s</a>
(OAK) as a “machine” that produces playoffs by trying to win more games
or score more points than opposing teams, using inputs in the form of
players’ ability to play well at bat and in the field.</p>
<p>Based on our expert knowledge of the game of baseball, our working
hypotheses, and the results of some previous analyses, we can construct
a conceptual model of how a baseball team functions, as outlined
below.</p>
<p><img src="conceptualModel.png"> <em>Conceptual model of how a
baseball team works.</em></p>
<p>The diagram shows clearly how this “machine” works: Its outputs are
qualifications for the playoffs, which it achieves by trying to win more
games or score more points than the opposing teams; to do this, it uses
inputs in the form of the players’ ability to play well at bat and in
the field; the inputs affecting the “machine’s” operation are also the
similar abilities of the opposing teams’ players. This is, of course, a
very simplistic causal model of how the OAK team operates, but as the
famous statistical aphorism states, <a
href="https://en.wikipedia.org/wiki/All_models_are_wrong">all models are
wrong, but some are useful</a>.</p>
<p>However incomplete our models of how an organization works will
always be, it is essential to check that these models sufficiently
reflect reality as conveyed by the available data. Only after such an
assessment of the plausibility of the model it is reasonable to base
further, e.g. hiring or L&amp;D decisions on it. And, as hinted at the
beginning of this post, we will use the statistical method of structural
equation modeling to do this. So let’s apply this method to our model of
the OAK and test its plausibility.</p>
<p>We will use data from a publicly available <a
href="https://drive.google.com/file/d/0B5YUO0Asd9KfMG1UaXpEVjJqQWc/view">database
of MLB historical statistics</a>. Specifically, we will use the
following variables:</p>
<ul>
<li>qualification for the playoffs in a given season
(<em>Playoffs</em>),</li>
<li>number of wins in a given season (<em>W</em>),</li>
<li>number of points won in a given season (<em>RS</em>),</li>
<li>number of points lost in a given season (<em>RA</em>),</li>
<li>average frequency with which a player reaches base per plate
appearance in a given season (<em>OBP</em> - On-Base Percentage) and
analogous statistics for opponent teams (<em>OOBP</em>),</li>
<li>average number of bases players earn per at bat in a given season
(<em>SLG</em> - Slugging Percentage) and analogous statistics for
opponent teams (<em>OSLG</em>).</li>
</ul>
<p>In terms of time, we will work with data from the years 1996-2001,
which precede 2002, when the story of Moneyball mostly takes place.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># uploading set of libraries for data manipulation and visualization</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>

<span class='co'># uploading data</span>
<span class='va'>baseball</span> <span class='op'>&lt;-</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"./baseball.csv"</span><span class='op'>)</span>

<span class='co'># filtering data used for the analysis</span>
<span class='va'>myData</span> <span class='op'>&lt;-</span> <span class='va'>baseball</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='va'>Year</span> <span class='op'>&lt;</span> <span class='fl'>2002</span>, 
    <span class='va'>Year</span> <span class='op'>&gt;</span> <span class='fl'>1995</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Team</span>, <span class='va'>OBP</span>, <span class='va'>SLG</span>, <span class='va'>OOBP</span>, <span class='va'>OSLG</span>, <span class='va'>RS</span>, <span class='va'>RA</span>, <span class='va'>W</span>, <span class='va'>Playoffs</span><span class='op'>)</span>

<span class='co'># user-friendly table with data used for the analysis</span>
<span class='fu'>DT</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/DT/man/datatable.html'>datatable</a></span><span class='op'>(</span>
  <span class='va'>myData</span>,
  class <span class='op'>=</span> <span class='st'>'cell-border stripe'</span>, 
  filter <span class='op'>=</span> <span class='st'>'top'</span>,
  extensions <span class='op'>=</span> <span class='st'>'Buttons'</span>,
  fillContainer <span class='op'>=</span> <span class='cn'>FALSE</span>,
  rownames<span class='op'>=</span> <span class='cn'>FALSE</span>,
  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    pageLength <span class='op'>=</span> <span class='fl'>5</span>, 
    autoWidth <span class='op'>=</span> <span class='cn'>TRUE</span>,
    dom <span class='op'>=</span> <span class='st'>'Bfrtip'</span>,
    buttons <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'copy'</span><span class='op'>)</span>, 
    scrollX <span class='op'>=</span> <span class='cn'>TRUE</span>, 
    selection<span class='op'>=</span><span class='st'>"multiple"</span>
  <span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<div id="htmlwidget-9112046ce475fa818139" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9112046ce475fa818139">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.31\" data-max=\"0.373\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.373\" data-max=\"0.485\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.301\" data-max=\"0.384\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0.377\" data-max=\"0.499\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"620\" data-max=\"1009\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"581\" data-max=\"1103\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"53\" data-max=\"116\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"fillContainer":false,"data":[["ANA","ARI","ATL","BAL","BOS","CHC","CHW","CIN","CLE","COL","DET","FLA","HOU","KCR","LAD","MIL","MIN","MON","NYM","NYY","OAK","PHI","PIT","SDP","SEA","SFG","STL","TBD","TEX","TOR","ANA","ARI","ATL","BAL","BOS","CHC","CHW","CIN","CLE","COL","DET","FLA","HOU","KCR","LAD","MIL","MIN","MON","NYM","NYY","OAK","PHI","PIT","SDP","SEA","SFG","STL","TBD","TEX","TOR","ANA","ARI","ATL","BAL","BOS","CHC","CHW","CIN","CLE","COL","DET","FLA","HOU","KCR","LAD","MIL","MIN","MON","NYM","NYY","OAK","PHI","PIT","SDP","SEA","SFG","STL","TBD","TEX","TOR","ANA","ARI","ATL","BAL","BOS","CHC","CHW","CIN","CLE","COL","DET","FLA","HOU","KCR","LAD","MIL","MIN","MON","NYM","NYY","OAK","PHI","PIT","SDP","SEA","SFG","STL","TBD","TEX","TOR","ANA","ATL","BAL","BOS","CHC","CHW","CIN","CLE","COL","DET","FLA","HOU","KCR","LAD","MIL","MIN","MON","NYM","NYY","OAK","PHI","PIT","SDP","SEA","SFG","STL","TEX","TOR","ATL","BAL","BOS","CAL","CHC","CHW","CIN","CLE","COL","DET","FLA","HOU","KCR","LAD","MIL","MIN","MON","NYM","NYY","OAK","PHI","PIT","SDP","SEA","SFG","STL","TEX","TOR"],[0.327,0.341,0.324,0.319,0.334,0.336,0.334,0.324,0.35,0.354,0.32,0.326,0.347,0.318,0.323,0.319,0.337,0.319,0.323,0.334,0.345,0.329,0.313,0.336,0.36,0.342,0.339,0.32,0.344,0.325,0.352,0.333,0.346,0.341,0.341,0.335,0.356,0.343,0.367,0.362,0.343,0.331,0.361,0.348,0.341,0.325,0.337,0.326,0.346,0.354,0.36,0.329,0.339,0.33,0.361,0.362,0.356,0.329,0.352,0.341,0.322,0.347,0.341,0.353,0.35,0.329,0.337,0.341,0.373,0.348,0.326,0.325,0.355,0.348,0.339,0.353,0.328,0.323,0.363,0.366,0.355,0.351,0.334,0.332,0.343,0.356,0.338,0.343,0.361,0.352,0.335,0.314,0.342,0.347,0.348,0.337,0.339,0.337,0.347,0.347,0.323,0.317,0.356,0.324,0.31,0.33,0.328,0.31,0.33,0.364,0.338,0.326,0.311,0.33,0.345,0.353,0.341,0.321,0.357,0.34,0.346,0.343,0.341,0.352,0.321,0.341,0.321,0.358,0.357,0.332,0.346,0.344,0.333,0.33,0.325,0.333,0.316,0.332,0.362,0.339,0.322,0.329,0.342,0.355,0.337,0.324,0.334,0.31,0.333,0.35,0.359,0.339,0.32,0.36,0.331,0.369,0.355,0.323,0.329,0.336,0.332,0.316,0.353,0.357,0.327,0.324,0.36,0.344,0.325,0.329,0.338,0.366,0.331,0.33,0.358,0.331],[0.405,0.442,0.412,0.38,0.439,0.43,0.451,0.419,0.458,0.483,0.409,0.423,0.451,0.409,0.425,0.426,0.433,0.396,0.387,0.435,0.439,0.414,0.393,0.399,0.445,0.46,0.441,0.388,0.471,0.43,0.472,0.429,0.429,0.435,0.423,0.411,0.47,0.447,0.47,0.455,0.438,0.409,0.477,0.425,0.431,0.403,0.407,0.432,0.43,0.45,0.458,0.4,0.424,0.402,0.442,0.472,0.455,0.399,0.446,0.469,0.395,0.459,0.436,0.447,0.448,0.42,0.429,0.451,0.467,0.472,0.443,0.395,0.42,0.433,0.42,0.426,0.384,0.427,0.434,0.453,0.446,0.431,0.419,0.393,0.455,0.434,0.426,0.411,0.479,0.457,0.415,0.393,0.453,0.447,0.463,0.433,0.444,0.402,0.448,0.461,0.415,0.373,0.436,0.399,0.387,0.396,0.389,0.394,0.394,0.46,0.397,0.395,0.374,0.409,0.468,0.421,0.441,0.385,0.462,0.448,0.416,0.426,0.429,0.463,0.396,0.417,0.389,0.467,0.478,0.415,0.395,0.403,0.407,0.418,0.398,0.409,0.425,0.405,0.436,0.423,0.385,0.404,0.407,0.485,0.414,0.396,0.438,0.389,0.432,0.472,0.457,0.431,0.401,0.447,0.422,0.475,0.472,0.42,0.393,0.397,0.398,0.384,0.441,0.425,0.406,0.412,0.436,0.452,0.387,0.407,0.402,0.484,0.388,0.407,0.469,0.42],[0.331,0.311,0.314,0.337,0.329,0.321,0.334,0.341,0.341,0.35,0.357,0.338,0.325,0.348,0.323,0.35,0.325,0.339,0.314,0.318,0.308,0.329,0.344,0.33,0.301,0.329,0.328,0.345,0.362,0.339,0.351,0.326,0.319,0.352,0.322,0.348,0.346,0.341,0.35,0.354,0.34,0.348,0.353,0.362,0.332,0.357,0.347,0.353,0.327,0.336,0.348,0.343,0.361,0.34,0.339,0.342,0.338,0.345,0.369,0.354,0.346,0.32,0.314,0.35,0.315,0.346,0.353,0.324,0.347,0.384,0.349,0.359,0.326,0.365,0.336,0.356,0.342,0.342,0.331,0.329,0.344,0.347,0.343,0.333,0.368,0.345,0.355,0.371,0.346,0.353,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[0.412,0.404,0.384,0.439,0.393,0.398,0.427,0.455,0.417,0.48,0.461,0.411,0.437,0.45,0.411,0.44,0.437,0.441,0.419,0.398,0.38,0.424,0.433,0.45,0.378,0.404,0.428,0.452,0.494,0.435,0.453,0.424,0.402,0.449,0.411,0.452,0.434,0.438,0.425,0.471,0.443,0.429,0.476,0.474,0.407,0.42,0.466,0.449,0.403,0.422,0.423,0.448,0.432,0.416,0.416,0.412,0.434,0.451,0.475,0.456,0.427,0.402,0.377,0.441,0.398,0.467,0.447,0.411,0.439,0.499,0.451,0.44,0.397,0.454,0.422,0.457,0.465,0.418,0.418,0.4,0.428,0.447,0.42,0.43,0.454,0.423,0.427,0.448,0.459,0.456,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[691,818,729,687,772,777,798,735,897,923,724,742,847,729,758,740,771,670,642,804,884,746,657,789,927,799,814,672,890,767,864,792,810,794,792,764,978,825,950,968,823,731,938,879,798,740,748,738,807,871,947,708,793,752,907,925,887,733,848,861,711,908,840,851,836,747,777,865,1009,906,747,691,823,856,793,815,686,718,853,900,893,841,775,710,859,872,809,772,945,883,787,665,826,817,876,831,861,750,850,826,722,667,874,714,669,707,734,644,706,965,804,713,650,749,859,845,810,620,940,816,829,791,812,851,687,779,651,868,923,784,740,777,747,742,681,772,691,777,891,764,668,725,795,925,784,689,807,654,773,949,928,762,772,898,778,952,961,783,688,753,746,703,894,877,741,746,871,861,650,776,771,993,752,759,928,766],[730,677,643,829,745,701,795,850,821,906,876,744,769,858,744,806,766,812,713,713,645,719,858,812,627,748,684,887,968,753,869,754,714,913,745,904,839,765,816,897,827,797,944,930,729,826,880,902,738,814,813,830,888,815,780,747,771,842,974,908,826,676,661,815,718,920,870,711,860,1028,882,852,675,921,787,886,845,853,711,731,846,846,782,781,905,831,838,913,859,862,783,812,581,785,729,792,931,760,779,855,863,923,620,899,678,812,818,783,645,656,866,808,718,635,855,739,782,751,871,768,794,581,681,857,759,833,764,815,908,790,669,660,820,645,742,861,740,709,688,946,840,760,891,833,793,708,823,694,648,903,921,943,771,794,773,769,964,1103,703,792,786,652,899,900,668,779,787,900,790,833,682,895,862,706,799,809],[75,92,88,63,82,88,83,66,91,73,66,76,93,65,86,68,85,68,82,95,102,86,62,79,116,90,93,62,73,80,82,85,95,74,85,65,95,85,90,82,79,79,72,77,86,73,69,67,94,87,91,65,69,76,91,97,95,69,71,83,70,100,103,78,94,67,75,96,97,72,69,64,97,64,77,74,63,68,97,98,87,77,78,74,79,86,75,69,95,84,85,65,106,79,92,90,80,77,89,77,65,54,102,72,83,74,70,65,88,114,74,75,69,98,76,89,83,63,88,88,84,101,98,78,68,80,76,86,83,79,92,84,67,88,78,68,78,88,96,65,68,79,76,90,90,73,77,76,96,88,85,70,76,85,81,99,83,53,80,82,75,90,80,78,88,71,92,78,67,73,91,85,68,88,90,74],[0,1,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,0,1,1,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,1,1,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,1,1,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,1,0]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>Team<\/th>\n      <th>OBP<\/th>\n      <th>SLG<\/th>\n      <th>OOBP<\/th>\n      <th>OSLG<\/th>\n      <th>RS<\/th>\n      <th>RA<\/th>\n      <th>W<\/th>\n      <th>Playoffs<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"autoWidth":true,"dom":"Bfrtip","buttons":["copy"],"scrollX":true,"selection":"multiple","columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p>Now let’s define a formal model of the OAK and fit it to the data
using the <a
href="https://cran.r-project.org/web/packages/brms/index.html">brms R
package</a> which allows us to make inferences about the model
parameters within a <a
href="https://nyu-cdsc.github.io/learningr/assets/kruschke_bayesian_in_R.pdf">Bayesian
inferential framework</a>. Specifically, we will build and fit a
so-called <em><a
href="https://en.wikipedia.org/wiki/Path_analysis_(statistics)">path
analysis</a></em> model, which is a special type of structural equation
modeling used to describe directed dependencies among a set of
variables. Given that we have data for a group of the same teams over
several seasons, we must also incorporate the hierarchical nature of the
data into the model.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># uploading libraries for fitting Bayesian generalized (non-)linear multivariate multilevel models using Stan for full Bayesian inference</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/paul-buerkner/brms'>brms</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mc-stan.org/cmdstanr/'>cmdstanr</a></span><span class='op'>)</span>

<span class='co'># specifying individual parts of the SEM (without modeling the correlation between response variables and using Student's t distribution instead of the Gaussian distribution to make the model more robust) </span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>W</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>RS</span> <span class='op'>+</span> <span class='va'>RA</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>RS</span> <span class='op'>+</span> <span class='va'>RA</span> <span class='op'>|</span> <span class='va'>Team</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>student</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>b</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>RA</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>OOBP</span> <span class='op'>+</span> <span class='va'>OSLG</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>OOBP</span> <span class='op'>+</span> <span class='va'>OSLG</span> <span class='op'>|</span> <span class='va'>Team</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>student</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>c</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>RS</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>OBP</span> <span class='op'>+</span> <span class='va'>SLG</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>OBP</span> <span class='op'>+</span> <span class='va'>SLG</span> <span class='op'>|</span> <span class='va'>Team</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>student</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula.html'>bf</a></span><span class='op'>(</span><span class='va'>Playoffs</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>W</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>+</span> <span class='va'>W</span> <span class='op'>|</span> <span class='va'>Team</span><span class='op'>)</span>, family <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsfamily.html'>bernoulli</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># fitting the model</span>
<span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/brm.html'>brm</a></span><span class='op'>(</span>
  <span class='va'>a</span> <span class='op'>+</span> <span class='va'>b</span> <span class='op'>+</span> <span class='va'>c</span> <span class='op'>+</span> <span class='va'>d</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/brms/man/brmsformula-helpers.html'>set_rescor</a></span><span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span>, 
  data <span class='op'>=</span> <span class='va'>myData</span>,
  iter <span class='op'>=</span> <span class='fl'>3000</span>,
  chains <span class='op'>=</span> <span class='fl'>3</span>,
  warmup <span class='op'>=</span> <span class='fl'>500</span>,
  thin <span class='op'>=</span> <span class='fl'>1</span>,
  seed <span class='op'>=</span> <span class='fl'>123</span>,
  cores <span class='op'>=</span> <span class='fl'>5</span>,
  backend <span class='op'>=</span> <span class='st'>"cmdstanr"</span>,
  refresh <span class='op'>=</span> <span class='fl'>0</span>,
  silent <span class='op'>=</span> <span class='fl'>2</span> 
  <span class='op'>)</span>

<span class='co'># checking MCMC convergence</span>
<span class='co'># plot(fit)</span>
<span class='co'># summary(fit)</span>
</code></pre>
</div>
</details>
</div>
<p>After verifying that the mechanics of the MCMC algorithm work well
(not shown here for brevity reasons), we should also verify how well the
model fits the data by using the posterior predictive check for each of
the observed response variables in our model.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># uploading library for arbitrarily complex composition of ggplot plots</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span>

<span class='co'># posterior predictive check for all predicted observed variables </span>
<span class='va'>playoffsPpc</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>fit</span>, resp <span class='op'>=</span> <span class='st'>"Playoffs"</span>, ndraws <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Playoffs variable"</span><span class='op'>)</span>
<span class='va'>wPpc</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>fit</span>, resp <span class='op'>=</span> <span class='st'>"W"</span>, ndraws <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"W variable"</span><span class='op'>)</span>
<span class='va'>rsPpc</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>fit</span>, resp <span class='op'>=</span> <span class='st'>"RS"</span>, ndraws <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"RS variable"</span><span class='op'>)</span>
<span class='va'>raPpc</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/pp_check.brmsfit.html'>pp_check</a></span><span class='op'>(</span><span class='va'>fit</span>, resp <span class='op'>=</span> <span class='st'>"RA"</span>, ndraws <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"RA variable"</span><span class='op'>)</span>

<span class='va'>ppc</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>playoffsPpc</span> <span class='op'>+</span> <span class='va'>wPpc</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>rsPpc</span> <span class='op'>+</span> <span class='va'>raPpc</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>ppc</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-3-1.png" width="1056" /></p>
</div>
<p>As you can see, the model fits the data pretty well. Now we can look
at the coefficients in the individual parts of the model. All of them
show non-zero values and are in directions that are consistent with our
expectations embodied in our conceptual model, i.e., all are positive
except for the coefficient of the <em>RA</em> variable (number of points
lost) as a predictor of the number of games won (<em>W</em>). These
results thus give us greater confidence in following our conceptual
model of team functioning when making decisions about allocating our
limited resources.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># uploading library for plotting functions for posterior analysis, MCMC diagnostics, prior and posterior predictive checks, and other visualizations to support the applied Bayesian workflow</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mc-stan.org/bayesplot/'>bayesplot</a></span><span class='op'>)</span>

<span class='co'># getting overview of all parameters </span>
<span class='co'># get_variables(fit)</span>
<span class='co'># relevant parameters: "b_RS_OBP", "b_RS_SLG", "b_RA_OOBP", "b_RA_OSLG", "b_W_RS", "b_W_RA", "b_Playoffs_W"</span>

<span class='va'>b_RS_OBP</span> <span class='op'>&lt;-</span> <span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_areas</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  pars <span class='op'>=</span> <span class='st'>"b_RS_OBP"</span>, 
  prob <span class='op'>=</span> <span class='fl'>0.95</span>,
  point_est <span class='op'>=</span> <span class='st'>"median"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"OBP variable in the RS ~ OBP part"</span>
    <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='op'>)</span>


<span class='va'>b_RS_SLG</span> <span class='op'>&lt;-</span> <span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_areas</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  pars <span class='op'>=</span> <span class='st'>"b_RS_SLG"</span>, 
  prob <span class='op'>=</span> <span class='fl'>0.95</span>,
  point_est <span class='op'>=</span> <span class='st'>"median"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"SLG variable in the RS ~ SLG part"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>


<span class='va'>b_RA_OOBP</span> <span class='op'>&lt;-</span> <span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_areas</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  pars <span class='op'>=</span> <span class='st'>"b_RA_OOBP"</span>, 
  prob <span class='op'>=</span> <span class='fl'>0.95</span>,
  point_est <span class='op'>=</span> <span class='st'>"median"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"OOBP variable in the RA ~ OOBP part"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>


<span class='va'>b_RA_OSLG</span> <span class='op'>&lt;-</span> <span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_areas</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  pars <span class='op'>=</span> <span class='st'>"b_RA_OSLG"</span>, 
  prob <span class='op'>=</span> <span class='fl'>0.95</span>,
  point_est <span class='op'>=</span> <span class='st'>"median"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"OSLG variable in the RA ~ OSLG part"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>


<span class='va'>b_W_RS</span> <span class='op'>&lt;-</span> <span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_areas</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  pars <span class='op'>=</span> <span class='st'>"b_W_RS"</span>, 
  prob <span class='op'>=</span> <span class='fl'>0.95</span>,
  point_est <span class='op'>=</span> <span class='st'>"median"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"RS variable in the W ~ RS part"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>


<span class='va'>b_W_RA</span> <span class='op'>&lt;-</span> <span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_areas</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  pars <span class='op'>=</span> <span class='st'>"b_W_RA"</span>, 
  prob <span class='op'>=</span> <span class='fl'>0.95</span>,
  point_est <span class='op'>=</span> <span class='st'>"median"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"RA variable in the W ~ RA part"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>


<span class='va'>b_Playoffs_W</span> <span class='op'>&lt;-</span> <span class='fu'>bayesplot</span><span class='fu'>::</span><span class='fu'><a href='https://mc-stan.org/bayesplot/reference/MCMC-intervals.html'>mcmc_areas</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  pars <span class='op'>=</span> <span class='st'>"b_Playoffs_W"</span>, 
  prob <span class='op'>=</span> <span class='fl'>0.95</span>,
  point_est <span class='op'>=</span> <span class='st'>"median"</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"W variable in the Playoffs ~ W part"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
    axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
    axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
  <span class='op'>)</span>


<span class='va'>coefCharts</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>b_RS_OBP</span> <span class='op'>+</span> <span class='va'>b_RS_SLG</span> <span class='op'>+</span> <span class='va'>b_RA_OOBP</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>b_RA_OSLG</span> <span class='op'>+</span> <span class='va'>b_W_RS</span> <span class='op'>+</span> <span class='va'>b_W_RA</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>b_Playoffs_W</span> <span class='op'>+</span> <span class='fu'>patchwork</span><span class='fu'>::</span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_spacer.html'>plot_spacer</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>patchwork</span><span class='fu'>::</span><span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_spacer.html'>plot_spacer</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://patchwork.data-imaginist.com/reference/plot_annotation.html'>plot_annotation</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>'Posterior interval estimations'</span>,
    caption <span class='op'>=</span> <span class='st'>"The solid vertical lines represent the point (median) estimates and the shaded areas represent the 95% credible interval."</span>,
    theme <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
      plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>18</span><span class='op'>)</span>,
      plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>11</span><span class='op'>)</span>
      <span class='op'>)</span>
    <span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>coefCharts</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-4-1.png" width="1056" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># summary of the fitted model  </span>
<span class='fu'><a href='https://mc-stan.org/cmdstanr/reference/fit-method-summary.html'>summary</a></span><span class='op'>(</span><span class='va'>fit</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code> Family: MV(student, student, student, bernoulli) 
  Links: mu = identity; sigma = identity; nu = identity
         mu = identity; sigma = identity; nu = identity
         mu = identity; sigma = identity; nu = identity
         mu = logit 
Formula: W ~ 1 + RS + RA + (1 + RS + RA | Team) 
         RA ~ 1 + OOBP + OSLG + (1 + OOBP + OSLG | Team) 
         RS ~ 1 + OBP + SLG + (1 + OBP + SLG | Team) 
         Playoffs ~ 1 + W + (1 + W | Team) 
   Data: myData (Number of observations: 90) 
  Draws: 3 chains, each with iter = 2500; warmup = 0; thin = 1;
         total post-warmup draws = 7500

Group-Level Effects: 
~Team (Number of levels: 30) 
                                   Estimate Est.Error l-95% CI
sd(W_Intercept)                        1.63      1.95     0.04
sd(W_RS)                               0.00      0.00     0.00
sd(W_RA)                               0.00      0.00     0.00
sd(RA_Intercept)                      12.21     10.88     0.57
sd(RA_OOBP)                           32.60     30.04     1.38
sd(RA_OSLG)                           26.88     23.83     1.07
sd(RS_Intercept)                      11.86     10.01     0.45
sd(RS_OBP)                            33.58     27.10     1.55
sd(RS_SLG)                            28.59     22.99     1.18
sd(Playoffs_Intercept)                 2.20      2.16     0.09
sd(Playoffs_W)                         0.22      0.47     0.00
cor(W_Intercept,W_RS)                 -0.24      0.50    -0.96
cor(W_Intercept,W_RA)                 -0.23      0.52    -0.97
cor(W_RS,W_RA)                        -0.22      0.51    -0.95
cor(RA_Intercept,RA_OOBP)             -0.20      0.51    -0.94
cor(RA_Intercept,RA_OSLG)             -0.21      0.51    -0.95
cor(RA_OOBP,RA_OSLG)                  -0.19      0.51    -0.95
cor(RS_Intercept,RS_OBP)              -0.16      0.52    -0.94
cor(RS_Intercept,RS_SLG)              -0.18      0.52    -0.95
cor(RS_OBP,RS_SLG)                    -0.20      0.51    -0.94
cor(Playoffs_Intercept,Playoffs_W)    -0.18      0.58    -0.98
                                   u-95% CI Rhat Bulk_ESS Tail_ESS
sd(W_Intercept)                        7.45 1.01     1084     1547
sd(W_RS)                               0.01 1.01      934     1938
sd(W_RA)                               0.01 1.01     1012     3299
sd(RA_Intercept)                      40.57 1.00     2271     3697
sd(RA_OOBP)                          111.19 1.00     1464     2342
sd(RA_OSLG)                           85.24 1.00      894     2025
sd(RS_Intercept)                      38.03 1.00     1569     1794
sd(RS_OBP)                           101.92 1.00      507      468
sd(RS_SLG)                            86.47 1.00      654     2468
sd(Playoffs_Intercept)                 7.42 1.00     2058     2623
sd(Playoffs_W)                         1.80 1.07       33       16
cor(W_Intercept,W_RS)                  0.79 1.00     4156     4013
cor(W_Intercept,W_RA)                  0.82 1.00     1522     1654
cor(W_RS,W_RA)                         0.80 1.00     3192     4270
cor(RA_Intercept,RA_OOBP)              0.81 1.00     3376     3918
cor(RA_Intercept,RA_OSLG)              0.80 1.00     3097     4358
cor(RA_OOBP,RA_OSLG)                   0.84 1.01     1295     1547
cor(RS_Intercept,RS_OBP)               0.85 1.00     1162     2565
cor(RS_Intercept,RS_SLG)               0.84 1.00      983     1246
cor(RS_OBP,RS_SLG)                     0.82 1.01      503     1922
cor(Playoffs_Intercept,Playoffs_W)     0.93 1.01      187      219

Population-Level Effects: 
                   Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS
W_Intercept           85.97      5.78    74.51    97.16 1.00     4765
RA_Intercept        -852.33     64.99  -982.24  -724.71 1.00     2989
RS_Intercept        -949.77     67.88 -1084.15  -820.70 1.00     4559
Playoffs_Intercept  -471.68    923.11 -3529.81   -41.17 1.07       30
W_RS                   0.10      0.01     0.09     0.11 1.00     3938
W_RA                  -0.10      0.01    -0.11    -0.09 1.00     4087
RA_OOBP             2850.08    297.29  2262.09  3420.05 1.00     2622
RA_OSLG             1600.06    187.41  1241.97  1976.70 1.00     4134
RS_OBP              3475.86    272.82  2955.81  4015.43 1.00     4594
RS_SLG              1330.99    160.56  1014.09  1637.60 1.00     3936
Playoffs_W             5.30     10.37     0.46    39.82 1.07       30
                   Tail_ESS
W_Intercept            4672
RA_Intercept           3771
RS_Intercept           5211
Playoffs_Intercept       16
W_RS                   5662
W_RA                   4003
RA_OOBP                2861
RA_OSLG                4506
RS_OBP                 3139
RS_SLG                 4062
Playoffs_W               16

Family Specific Parameters: 
         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_W      3.30      0.31     2.70     3.91 1.00     1995     1334
sigma_RA    22.29      2.41    17.83    27.36 1.00     1130     1360
sigma_RS    18.97      2.15    14.93    23.35 1.00     2979     3893
nu_W        23.65     14.23     5.60    59.37 1.00     2419     1912
nu_RA       21.98     14.02     4.93    57.35 1.00     1839     2379
nu_RS       20.98     13.86     4.49    56.41 1.00     1853     2595

Draws were sampled using sample(hmc). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<p>However, the main advantage of such a formalized model is that we can
now make specific predictions or simulations that will help us make more
granular decisions about where and how much to invest our limited
resources, e.g. in terms of hiring and/or L&amp;D activities. For
example, we know from the available data that teams need to win
approximately 95 games to have a high chance of making the playoffs -
see the two graphs below.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># wins to make playoffs - chart 1</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>myData</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='co'># creating random numbers for dispersing points across the y axis of the graph</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>rnd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>176</span>,<span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>W</span>, y <span class='op'>=</span> <span class='va'>rnd</span>, color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>Playoffs</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>3</span>, alpha <span class='op'>=</span> <span class='fl'>0.8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>120</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>50</span>,<span class='fl'>120</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#9e9e9e"</span>, <span class='st'>"#ff1919"</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"The team has not made it to the playoffs"</span>, <span class='st'>"The team has made it to the playoffs"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"Teams that didn't/made the playoffs from 1996-2001"</span>,
    x <span class='op'>=</span> <span class='st'>"NUMBER OF GAMES WON IN THE REGULAR SEASON"</span>,
    y <span class='op'>=</span> <span class='st'>""</span>,
    color <span class='op'>=</span> <span class='st'>""</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>18</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>12</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>16</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>11</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.x.bottom <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.y.left <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                 axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 axis.line.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.line.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 legend.position<span class='op'>=</span><span class='st'>"top"</span>,
                 legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,
                 legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
                 panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>,
                 panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 plot.margin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='st'>"mm"</span><span class='op'>)</span>, 
                 plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,
                 plot.caption.position <span class='op'>=</span>  <span class='st'>"plot"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-6-1.png" width="1056" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># wins to make playoffs - chart 2</span>

<span class='co'># creating a table with several different values for the number of wins in the regular season</span>
<span class='va'>nWins</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>115</span>,<span class='fl'>5</span><span class='op'>)</span>
<span class='va'>makingPlayoffsProb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span>mode<span class='op'>=</span><span class='st'>"numeric"</span>, length<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>nWins</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>playoffsData</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>nWins <span class='op'>=</span> <span class='va'>nWins</span>, makingPlayoffsProb <span class='op'>=</span> <span class='va'>makingPlayoffsProb</span><span class='op'>)</span>

<span class='co'># calculating the probability of advancing to the playoffs with different number of wins in the regular season</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>playoffsData</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='va'>playoffsData</span><span class='op'>$</span><span class='va'>makingPlayoffsProb</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>myData</span><span class='op'>$</span><span class='va'>W</span><span class='op'>[</span><span class='va'>myData</span><span class='op'>$</span><span class='va'>W</span> <span class='op'>&gt;=</span> <span class='va'>playoffsData</span><span class='op'>$</span><span class='va'>nWins</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&amp;</span> <span class='va'>myData</span><span class='op'>$</span><span class='va'>Playoffs</span> <span class='op'>==</span> <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>myData</span><span class='op'>$</span><span class='va'>W</span><span class='op'>[</span><span class='va'>myData</span><span class='op'>$</span><span class='va'>W</span> <span class='op'>&gt;=</span> <span class='va'>playoffsData</span><span class='op'>$</span><span class='va'>nWins</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> 
  
<span class='op'>}</span>

<span class='co'># creating the graph</span>
<span class='va'>playoffsData</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>nWins</span>, y <span class='op'>=</span> <span class='va'>makingPlayoffsProb</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='st'>"NUMBER OF GAMES WON IN THE REGULAR SEASON"</span>,
    y <span class='op'>=</span> <span class='st'>"PROBABILITY OF MAKING IT TO THE PLAYOFFS"</span>,
    title <span class='op'>=</span> <span class='st'>"Relation between the number of wins in the regular season and the probability\nof advancing to the playoffs (1996-2001)"</span>
    <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>115</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>60</span>,<span class='fl'>115</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>0.1</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent_format</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>18</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>16</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>11</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.x.bottom <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.y.left <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>15</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                 axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.line.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.line.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 legend.position<span class='op'>=</span><span class='st'>"top"</span>,
                 legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,
                 legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
                 panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.major.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>,
                 panel.grid.major.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>,
                 panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 plot.margin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='st'>"mm"</span><span class='op'>)</span>, 
                 plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,
                 plot.caption.position <span class='op'>=</span>  <span class='st'>"plot"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-7-1.png" width="1056" /></p>
</div>
<p>Considering the last known OAK performance statistics from 2001, what
number of games can OAK expect to win and what is the likelihood of
making the playoffs next year? Let’s plug the 2001 OAK numbers into the
model and check the prediction including all uncertainties.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># summary prediction of the number of matches won by OAK in 2002 using OAK's statistics from 2001 as input</span>
<span class='co'># set.seed(123)</span>
<span class='co'># predict(</span>
<span class='co'>#   fit, </span>
<span class='co'>#   resp = "W", </span>
<span class='co'>#   newdata = baseball %&gt;% dplyr::filter(Year == 2001, Team == "OAK") %&gt;% dplyr::select(Team, RS, RA, W, Playoffs, OBP, SLG, OOBP, OSLG)</span>
<span class='co'># )</span>

<span class='co'># generating predictions using OAK's statistics from 2001 as input</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>wp</span> <span class='op'>&lt;-</span> <span class='fu'>brms</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/brms/man/posterior_predict.brmsfit.html'>posterior_predict</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  resp <span class='op'>=</span> <span class='st'>"W"</span>, 
  newdata <span class='op'>=</span> <span class='va'>baseball</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Year</span> <span class='op'>==</span> <span class='fl'>2001</span>, <span class='va'>Team</span> <span class='op'>==</span> <span class='st'>"OAK"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Team</span>, <span class='va'>RS</span>, <span class='va'>RA</span>, <span class='va'>W</span>, <span class='va'>Playoffs</span>, <span class='va'>OBP</span>, <span class='va'>SLG</span>, <span class='va'>OOBP</span>, <span class='va'>OSLG</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># actual number of matches won by OAK in 2002</span>
<span class='va'>realNWins</span> <span class='op'>&lt;-</span> <span class='va'>baseball</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Year</span> <span class='op'>==</span> <span class='fl'>2002</span>, <span class='va'>Team</span> <span class='op'>==</span> <span class='st'>"OAK"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/pull.html'>pull</a></span><span class='op'>(</span><span class='va'>W</span><span class='op'>)</span>

<span class='co'># uploading library for visualizations of distributions and uncertainty</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mjskay.github.io/ggdist/'>ggdist</a></span><span class='op'>)</span>

<span class='co'># creating the graph</span>
<span class='va'>wp</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>V1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggdist</span><span class='fu'>::</span><span class='fu'><a href='http://mjskay.github.io/ggdist/reference/stat_halfeye.html'>stat_halfeye</a></span><span class='op'>(</span>
    fill <span class='op'>=</span> <span class='st'>"lightblue"</span>,
    .width <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.80</span>, <span class='fl'>0.95</span><span class='op'>)</span>,
      <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept <span class='op'>=</span> <span class='va'>realNWins</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>realNWins</span><span class='op'>+</span><span class='fl'>8.3</span>, y <span class='op'>=</span> <span class='fl'>1</span>, label <span class='op'>=</span> <span class='st'>"Actual number of matches won by OAK in 2002"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>80</span>,<span class='fl'>120</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='st'>"PREDICTED NUMBER OF MATCHES WON (W)"</span>,
    y <span class='op'>=</span> <span class='st'>"DENSITY"</span>,
    linetype <span class='op'>=</span> <span class='st'>""</span>,
    title <span class='op'>=</span> <span class='st'>"Predicted number of matches won by OAK in 2002"</span>,
    caption <span class='op'>=</span> <span class='st'>"\nThe black horizontal lines at the bottom of the graph represent the 80% and 95% probability intervals, respectively."</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>18</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>16</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>11</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.x.bottom <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.y.left <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>15</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                 axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.line.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.line.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 legend.position<span class='op'>=</span> <span class='st'>"none"</span>,
                 legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,
                 legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
                 panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 plot.margin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='st'>"mm"</span><span class='op'>)</span>, 
                 plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,
                 plot.caption.position <span class='op'>=</span>  <span class='st'>"plot"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-8-1.png" width="1056" /></p>
</div>
<p>We can see that the 95% probability interval of the predicted number
of games won by the OAK in 2002 is safely above the 95-point threshold.
And when we compare the prediction to the 2002 reality, we see that they
are pretty close. Also, the projected probability of OAK advancing to
the playoffs is very high, which is consistent with the fact that OAK
successfully qualified for the playoffs in 2002.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># prediction of OAK making the playoffs in 2002 using OAK's statistics from 2001 as input </span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span>
  <span class='va'>fit</span>, 
  resp <span class='op'>=</span> <span class='st'>"Playoffs"</span>, 
  newdata <span class='op'>=</span> <span class='va'>baseball</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Year</span> <span class='op'>==</span> <span class='fl'>2001</span>, <span class='va'>Team</span> <span class='op'>==</span> <span class='st'>"OAK"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>Team</span>, <span class='va'>RS</span>, <span class='va'>RA</span>, <span class='va'>W</span>, <span class='va'>Playoffs</span>, <span class='va'>OBP</span>, <span class='va'>SLG</span>, <span class='va'>OOBP</span>, <span class='va'>OSLG</span><span class='op'>)</span>,
  probs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.025</span>, <span class='fl'>0.5</span>, <span class='fl'>0.975</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>      Estimate Est.Error Q2.5 Q50 Q97.5
[1,] 0.9993333  0.025813    1   1     1</code></pre>
</div>
<p>Based on this information, we may conclude that there is no urgent
need to invest heavily now in increasing the current quality of the
team’s play at bat and in the field (variables <em>OBP</em> and
<em>SLG</em>), assuming that the opposing teams do not significantly
increase the quality of their play next year (variables <em>OOBP</em>
and <em>OSLG</em>). Using the model, we can also obtain a specific range
of the quality of the OAK’s play at bat and in the field that would
still allow it to reach at least 95 games won. Such information could be
useful, for example, in deciding which players can be safely traded
without having a detrimental effect on the likelihood of making the
playoffs.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># simulation of the effect of SLG and OBP on the number of OAK games won in 2002</span>

<span class='co'># getting plausible range of values of OBP and SLG variables</span>
<span class='va'>stats</span> <span class='op'>&lt;-</span> <span class='va'>baseball</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='va'>Year</span> <span class='op'>&lt;</span> <span class='fl'>2002</span>, 
    <span class='va'>Year</span> <span class='op'>&gt;</span> <span class='fl'>1995</span>, 
    <span class='va'>Team</span> <span class='op'>==</span> <span class='st'>"OAK"</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>OBP</span>, <span class='va'>SLG</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>mean <span class='op'>=</span> <span class='va'>mean</span>, sd <span class='op'>=</span> <span class='va'>sd</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='co'># creating a sequence of plausible values for OBP and SLG variables (3 SDs around the mean value)   </span>
<span class='va'>OBPSeq</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>stats</span><span class='op'>$</span><span class='va'>OBP_mean</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>3</span><span class='op'>*</span><span class='va'>stats</span><span class='op'>$</span><span class='va'>OBP_sd</span><span class='op'>)</span>, to <span class='op'>=</span> <span class='va'>stats</span><span class='op'>$</span><span class='va'>OBP_mean</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>3</span><span class='op'>*</span><span class='va'>stats</span><span class='op'>$</span><span class='va'>OBP_sd</span><span class='op'>)</span>, length.out <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>
<span class='va'>SLGSeq</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span>from <span class='op'>=</span> <span class='va'>stats</span><span class='op'>$</span><span class='va'>SLG_mean</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>3</span><span class='op'>*</span><span class='va'>stats</span><span class='op'>$</span><span class='va'>SLG_sd</span><span class='op'>)</span>, to <span class='op'>=</span> <span class='va'>stats</span><span class='op'>$</span><span class='va'>SLG_mean</span> <span class='op'>-</span> <span class='op'>(</span><span class='fl'>3</span><span class='op'>*</span><span class='va'>stats</span><span class='op'>$</span><span class='va'>SLG_sd</span><span class='op'>)</span>, length.out <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span>

<span class='co'># creating df with all possible combinations of plausible values of OBP and SLG variables</span>
<span class='va'>simDf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/expand.grid.html'>expand.grid</a></span><span class='op'>(</span>OBP <span class='op'>=</span> <span class='va'>OBPSeq</span>, SLG <span class='op'>=</span> <span class='va'>SLGSeq</span><span class='op'>)</span>

<span class='co'># getting variables necessary for prediction (statistics of OAK's opponent teams from 2001)</span>
<span class='va'>statsO</span> <span class='op'>&lt;-</span> <span class='va'>baseball</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Year</span> <span class='op'>==</span> <span class='fl'>2001</span>, <span class='va'>Team</span> <span class='op'>==</span> <span class='st'>"OAK"</span><span class='op'>)</span> 

<span class='co'># adding Team and W variables</span>
<span class='va'>simDf</span> <span class='op'>&lt;-</span> <span class='va'>simDf</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>
    Team <span class='op'>=</span> <span class='st'>"OAK"</span>,
    W <span class='op'>=</span> <span class='cn'>NaN</span>
  <span class='op'>)</span>

<span class='co'># running the simulation</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>simDf</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  
  <span class='co'>#print(i)</span>
  
  <span class='co'># prediction of the RS response variable</span>
  <span class='va'>RSPred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span>
    <span class='va'>fit</span>, 
    resp <span class='op'>=</span> <span class='st'>"RS"</span>, 
    newdata <span class='op'>=</span> <span class='va'>simDf</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>]</span>
  <span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  
  <span class='co'># prediction of the W response variable</span>
  <span class='va'>WPred</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span>
    <span class='va'>fit</span>, 
    resp <span class='op'>=</span> <span class='st'>"W"</span>, 
    newdata <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Team <span class='op'>=</span> <span class='st'>"OAK"</span>, RS <span class='op'>=</span> <span class='va'>RSPred</span>, RA <span class='op'>=</span> <span class='va'>statsO</span><span class='op'>$</span><span class='va'>RA</span><span class='op'>)</span>
  <span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  
  <span class='va'>simDf</span><span class='op'>[</span><span class='va'>i</span>,<span class='st'>"W"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>WPred</span>  
  
<span class='op'>}</span>

<span class='co'># creating the graph</span>
<span class='va'>simDf</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>OBP</span>, y <span class='op'>=</span> <span class='va'>SLG</span>, color <span class='op'>=</span> <span class='va'>W</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>18</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.36</span>, <span class='fl'>0.52</span>, <span class='fl'>0.02</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0.32</span>, <span class='fl'>0.38</span>, <span class='fl'>0.01</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_gradient.html'>scale_colour_gradient2</a></span><span class='op'>(</span>
    low <span class='op'>=</span> <span class='st'>"blue"</span>,
    mid <span class='op'>=</span> <span class='st'>"white"</span>,
    high <span class='op'>=</span> <span class='st'>"red"</span>,
    midpoint <span class='op'>=</span> <span class='fl'>95</span>,
    space <span class='op'>=</span> <span class='st'>"Lab"</span>,
    na.value <span class='op'>=</span> <span class='st'>"grey50"</span>,
    guide <span class='op'>=</span> <span class='st'>"colourbar"</span>,
    aesthetics <span class='op'>=</span> <span class='st'>"colour"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"Simulation of the effect of SLG and OBP on the number of OAK games won in 2002"</span>,
    caption <span class='op'>=</span> <span class='st'>"The white color corresponds to the 95-point threshold to qualify for the playoffs."</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>18</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>16</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>11</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.x.bottom <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.y.left <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>15</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                 axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.line.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.line.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 legend.position<span class='op'>=</span> <span class='st'>"bottom"</span>,
                 legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,
                 legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
                 panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 plot.margin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='st'>"mm"</span><span class='op'>)</span>, 
                 plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,
                 plot.caption.position <span class='op'>=</span>  <span class='st'>"plot"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-10-1.png" width="1056" /></p>
</div>
<p>As many of you know, thanks to similar analyses, the OAK management
began to select players for their team who, although they did not meet
the traditional criteria by which scouts judged the quality of baseball
players, exhibited exactly those characteristics that, according to
conducted analyses, predicted the number of points won and lost, and
thus the likelihood of advancing to the playoffs, which was the
management’s main goal. Because competing teams underestimated the
importance of these player statistics and overestimated other, less
important variables (e.g., batting average), OAK management was able to
purchase players relatively inexpensively who enabled them to achieve
their goals. As a result, the OAK won 20 more games per season than
similarly “poor” teams and about the same number of games as 2 to 3
times richer competition. The power of data in practice!</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># salaries vs number of matches won </span>
<span class='co'># uploading data from the Lahman's Baseball Database, which is publicly available at https://www.seanlahman.com/baseball-archive/statistics/</span>

<span class='va'>playersSalaries</span> <span class='op'>&lt;-</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"./salaries.csv"</span><span class='op'>)</span>
<span class='va'>teamsWins</span> <span class='op'>&lt;-</span> <span class='fu'>readr</span><span class='fu'>::</span><span class='fu'><a href='https://readr.tidyverse.org/reference/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"./teams.csv"</span><span class='op'>)</span>

<span class='co'># computing average sum of salaries paid by each team to its players in 1998-2001</span>
<span class='va'>playersSalariesAvg</span> <span class='op'>&lt;-</span> <span class='va'>playersSalaries</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='va'>yearID</span> <span class='op'>&gt;</span> <span class='fl'>1997</span>,
    <span class='va'>yearID</span> <span class='op'>&lt;</span> <span class='fl'>2002</span>
    <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>teamID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>playersSalariesAvg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>salary</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>yearID</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># calculating the average number of wins per season for each team from 1998-2001</span>
<span class='va'>teamsWinsAvg</span> <span class='op'>&lt;-</span> <span class='va'>teamsWins</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='va'>yearID</span> <span class='op'>&gt;</span> <span class='fl'>1997</span>,
    <span class='va'>yearID</span> <span class='op'>&lt;</span> <span class='fl'>2002</span>
  <span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>teamID</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>teamsWinsAvg <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>W</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>yearID</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>



<span class='va'>playersSalariesAvg</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>teamsWinsAvg</span> , <span class='st'>"teamID"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>OAK <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>teamID</span> <span class='op'>==</span> <span class='st'>"OAK"</span>, <span class='st'>"yes"</span>, <span class='st'>"no"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span> <span class='va'>playersSalariesAvg</span>, y <span class='op'>=</span> <span class='va'>teamsWinsAvg</span>, fill <span class='op'>=</span> <span class='va'>OAK</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
    title <span class='op'>=</span> <span class='st'>"Player salaries and number of wins in 1998-2001"</span>,
    x <span class='op'>=</span> <span class='st'>"AVERAGE SUM OF PLAYERS' SALARIES (USD)"</span>,
    y <span class='op'>=</span> <span class='st'>"AVERAGE NUMBER OF WINS PER SEASON"</span>
    <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggrepel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_label_repel</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>teamID</span><span class='op'>)</span>,
    box.padding <span class='op'>=</span> <span class='fl'>0.25</span>, point.padding <span class='op'>=</span> <span class='fl'>0.25</span>,
    segment.color <span class='op'>=</span> <span class='st'>'grey50'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>
    values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#ffffff"</span>, <span class='st'>"#ffd400"</span><span class='op'>)</span>, 
    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"no"</span>,<span class='st'>"yes"</span><span class='op'>)</span>
    <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>65</span>,<span class='fl'>100</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>65</span>,<span class='fl'>100</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2e+07</span>,<span class='fl'>9e+07</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>2e+07</span>,<span class='fl'>9e+07</span>,<span class='fl'>1e+07</span><span class='op'>)</span>, labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/comma.html'>number_format</a></span><span class='op'>(</span>scale <span class='op'>=</span> <span class='fl'>0.000001</span>, suffix <span class='op'>=</span> <span class='st'>"M"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"bold"</span>, size <span class='op'>=</span> <span class='fl'>18</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>16</span>, margin<span class='op'>=</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span>,<span class='fl'>20</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
                 plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>11</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.x.bottom <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
                 axis.title.y.left <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>15</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>13</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
                 axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span>, lineheight <span class='op'>=</span> <span class='fl'>16</span><span class='op'>)</span>,
                 axis.line.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.line.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 legend.position<span class='op'>=</span><span class='st'>"node"</span>,
                 legend.key <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_rect</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span>,
                 legend.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>'#2C2F46'</span>, face <span class='op'>=</span> <span class='st'>"plain"</span>, size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
                 panel.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.major <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 panel.grid.minor <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
                 axis.ticks.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 axis.ticks.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_line</a></span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"#E0E1E6"</span><span class='op'>)</span>,
                 plot.margin<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span>,<span class='st'>"mm"</span><span class='op'>)</span>, 
                 plot.title.position <span class='op'>=</span> <span class='st'>"plot"</span>,
                 plot.caption.position <span class='op'>=</span>  <span class='st'>"plot"</span>
  <span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="hrm-value-chain-and-sem_files/figure-html5/unnamed-chunk-11-1.png" width="1056" /></p>
</div>
<p>Finally, let’s breathe some life into the dry numbers by watching a
short clip from the <a
href="https://www.imdb.com/title/tt1210166/">Moneyball film</a>, which
nicely summarizes some of the ideas presented in this blog post.</p>
<video src="MoneyballClip1.mp4" controls preload>
</video>
<div class="sourceCode" id="cb3"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2023-02-08-hrm-value-chain-and-sem/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fblog-about-people-analytics.netlify.com%2Fposts%2F2023-02-08-hrm-value-chain-and-sem%2F&amp;title=HRM%20value%20chain%20and%20structural%20equation%20modeling%20-%20Moneyball%20case">
        <i class="fab fa-linkedin"></i>
      </a>
      <a href="https://twitter.com/share?text=HRM%20value%20chain%20and%20structural%20equation%20modeling%20-%20Moneyball%20case&amp;url=https%3A%2F%2Fblog-about-people-analytics.netlify.com%2Fposts%2F2023-02-08-hrm-value-chain-and-sem%2F">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fblog-about-people-analytics.netlify.com%2Fposts%2F2023-02-08-hrm-value-chain-and-sem%2F">
        <i class="fab fa-facebook"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://ludeks-peopleanalyticsblog.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/';
  this.page.identifier = 'posts/2023-02-08-hrm-value-chain-and-sem/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://ludeks-peopleanalyticsblog.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Stehlík (2023, Feb. 8). Ludek's Blog About People Analytics: HRM value chain and structural equation modeling - Moneyball case. Retrieved from https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{stehlík2023hrm,
  author = {Stehlík, Ludek},
  title = {Ludek's Blog About People Analytics: HRM value chain and structural equation modeling - Moneyball case},
  url = {https://blog-about-people-analytics.netlify.com/posts/2023-02-08-hrm-value-chain-and-sem/},
  year = {2023}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
